<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SRA 数据下载自救指南 | 思考问题的熊</title>
<meta name="description" content="很高兴和你相遇<br>这里正在记录我的所思所学" />
<link rel="shortcut icon" href="https://kaopubear.top//favicon.ico?v=1576309192768">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://kaopubear.top//styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://kaopubear.top/">
  <img class="avatar" src="https://kaopubear.top//images/avatar.png?v=1576309192768" alt="">
  </a>
  <h1 class="site-title">
    思考问题的熊
  </h1>
  <p class="site-description">
    很高兴和你相遇<br>这里正在记录我的所思所学
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
      
        <a href="/post/resource" class="menu">
          资料
        </a>
      
    
      
        <a href="/post/project" class="menu">
          项目
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              SRA 数据下载自救指南
            </h2>
            <div class="post-info">
              <span>
                2018-09-19
              </span>
              <span>
                6 min read
              </span>
              
                <a href="https://kaopubear.top//tag/p7M9e5leM" class="post-tag">
                  # RNA-seq
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://raw.githubusercontent.com/fei0810/image-host/master/img/177622-cb08a9dbc837b77e.png" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <blockquote>
<p>还在羡慕海峡那边的朋友下载 SRA 快到飞起？还在难过用 wget 下载数据经常下载不完整？用了官方的下载工具还是慢的不行？这里有一个 SRA 下载自救尝试指南供你参考。</p>
</blockquote>
<h2 id="需要用到两个工具">需要用到两个工具</h2>
<ul>
<li>SRA Toolkit</li>
<li>IBM aspera 高速文件传输工具</li>
</ul>
<p><strong>因为这是一篇极简自救指南，所以一切都不解释，直接给出链接，不明白的自行学习（爱学不学）。</strong></p>
<p>SRA Toolkit 网址：https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=toolkit_doc</p>
<p>aspera 网址：https://support.asperasoft.com/hc/en-us</p>
<p>aspera 官方对于下载 NCBI 数据的说明</p>
<p><a href="https://support.asperasoft.com/hc/en-us/articles/216125898-Downloading-data-from-NCBI-via-the-command-line">https://support.asperasoft.com/hc/en-us/articles/216125898-Downloading-data-from-NCBI-via-the-command-line</a></p>
<!--more-->
<p>SRA Toolkit 官方对于使用 aspera 的说明：</p>
<p>https://www.ncbi.nlm.nih.gov/books/NBK242625/</p>
<p><a href="https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=toolkit_doc&amp;f=prefetch">https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=toolkit_doc&amp;f=prefetch</a></p>
<h2 id="快速自救前奏">快速自救前奏</h2>
<ul>
<li>下载 aspera （选择 linux 版本）</li>
</ul>
<p><a href="https://downloads.asperasoft.com/en/downloads/8?list">https://downloads.asperasoft.com/en/downloads/8?list</a></p>
<ul>
<li>安装 aspera</li>
</ul>
<pre><code class="language-sh">wget https://download.asperasoft.com/download/sw/connect/3.8.1/ibm-aspera-connect-3.8.1.161274-linux-g2.12-64.tar.gz
# 小心版本号有变动，不要直接复制上面的命令
tar zxvf ibm-aspera-connect-3.8.1.161274-linux-g2.12-64.tar.gz
bash ibm-aspera-connect-3.8.1.161274-linux-g2.12-64.sh
# 默认安装路径 /home/user/.aspera
</code></pre>
<ul>
<li>安装 sra toolkit 具体命令省略，注意一定要安装最新版本：）</li>
</ul>
<h2 id="正式开始自救">正式开始自救</h2>
<blockquote>
<p>目前中文关于使用 aspera 下载 sra 数据的几篇教程都写的婆婆妈妈乱七八糟，<strong>千万不要再看了</strong>！</p>
</blockquote>
<p>记住，正式的自救只需要两步，其它写一大串的文章都是“耍流氓”。</p>
<ol>
<li>
<p>把要下载的数据 SRR 号写入一个文件 srr.txt，每行是一个 SRR id</p>
</li>
<li>
<p>利用 SRA toolkit 的 <code>prefetch</code> 下载，并指定下载方式为 <code>ascp</code>，命令如下，各种参数的含义自行查看文档（爱看不看）</p>
</li>
</ol>
<pre><code class="language-sh">prefetch -t ascp -a &quot;/home/user/.aspera/connect/bin/ascp|/home/user/.aspera/connect/etc/asperaweb_id_dsa.openssh&quot; --option-file srr.txt -O /opt/user/ncbi
</code></pre>
<p>其中-a 参数中必须要用<strong>绝对路径</strong>写上 ascp 所在的位置和 previte KEY 的位置，如果是正常安装只需要把 user 替换为自己的用户名。</p>
<h2 id="自救效果测试">自救效果测试</h2>
<p>下载了八个 SRR 文件，平均一个大小 5G 左右，使用时间如下：</p>
<pre><code class="language-sh">2018-09-05T14:14:33 prefetch.2.9.2: 1) Downloading 'SRR******'...
2018-09-05T14:14:33 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:16:58 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:16:58 prefetch.2.9.2: 1) 'SRR******' was downloaded successfully

2018-09-05T14:17:01 prefetch.2.9.2: 2) Downloading 'SRR******'...
2018-09-05T14:17:01 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:19:25 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:19:25 prefetch.2.9.2: 2) 'SRR******' was downloaded successfully

2018-09-05T14:19:28 prefetch.2.9.2: 3) Downloading 'SRR******'...
2018-09-05T14:19:28 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:22:31 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:22:31 prefetch.2.9.2: 3) 'SRR******' was downloaded successfully

2018-09-05T14:22:35 prefetch.2.9.2: 4) Downloading 'SRR******'...
2018-09-05T14:22:35 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:25:14 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:25:14 prefetch.2.9.2: 4) 'SRR******' was downloaded successfully

2018-09-05T14:25:17 prefetch.2.9.2: 5) Downloading 'SRR******'...
2018-09-05T14:25:17 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:26:46 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:26:46 prefetch.2.9.2: 5) 'SRR******' was downloaded successfully

2018-09-05T14:26:49 prefetch.2.9.2: 6) Downloading 'SRR******'...
2018-09-05T14:26:49 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:28:13 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:28:13 prefetch.2.9.2: 6) 'SRR******' was downloaded successfully

2018-09-05T14:28:16 prefetch.2.9.2: 7) Downloading 'SRR******'...
2018-09-05T14:28:16 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:29:56 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:29:56 prefetch.2.9.2: 7) 'SRR******' was downloaded successfully

2018-09-05T14:30:00 prefetch.2.9.2: 8) Downloading 'SRR******'...
2018-09-05T14:30:00 prefetch.2.9.2:  Downloading via fasp...
SRR******
2018-09-05T14:31:58 prefetch.2.9.2:  fasp download succeed
2018-09-05T14:31:58 prefetch.2.9.2: 8) 'SRR******' was downloaded successfully
</code></pre>
<p>喏，5G 的文件，即便是在（你懂的）这种网络状况下，<strong>一个也只需要不到 2 分钟</strong>。<br>
自救成功，祝好！</p>
<hr>
<figure data-type="image" tabindex="1"><img src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" alt=""></figure>
<p><strong>本文作者</strong>：思考问题的熊</p>
<p><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议 (CC BY-NC-ND 4.0)</a> 进行许可。</p>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/fei0810/image-host/master/img/20190628083754.png" alt="扫码即刻沟通"></figure>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0%E4%B8%A4%E4%B8%AA%E5%B7%A5%E5%85%B7">需要用到两个工具</a></li>
<li><a href="#%E5%BF%AB%E9%80%9F%E8%87%AA%E6%95%91%E5%89%8D%E5%A5%8F">快速自救前奏</a></li>
<li><a href="#%E6%AD%A3%E5%BC%8F%E5%BC%80%E5%A7%8B%E8%87%AA%E6%95%91">正式开始自救</a></li>
<li><a href="#%E8%87%AA%E6%95%91%E6%95%88%E6%9E%9C%E6%B5%8B%E8%AF%95">自救效果测试</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://kaopubear.top//post/2018-08-25-rnaseqtimedata">
              <h3 class="post-title">
                转录组时间序列数据小结
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  欢迎加入我的 <a href="https://t.zsxq.com/UjiEaYZ" target="_blank">知识星球</a> | 
  <a class="rss" href="https://kaopubear.top//atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()

  let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

  // This should probably be throttled.
  // Especially because it triggers during smooth scrolling.
  // https://lodash.com/docs/4.17.10#throttle
  // You could do like...
  // window.addEventListener("scroll", () => {
  //    _.throttle(doThatStuff, 100);
  // });
  // Only not doing it here to keep this Pen dependency-free.

  window.addEventListener("scroll", event => {
    let fromTop = window.scrollY;

    mainNavLinks.forEach((link, index) => {
      let section = document.getElementById(decodeURI(link.hash).substring(1));
      let nextSection = null
      if (mainNavLinks[index + 1]) {
        nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
      }
      if (section.offsetTop <= fromTop) {
        if (nextSection) {
          if (nextSection.offsetTop > fromTop) {
            link.classList.add("current");
          } else {
            link.classList.remove("current");    
          }
        } else {
          link.classList.add("current");
        }
      } else {
        link.classList.remove("current");
      }
    });
  });

</script>

      </div>
    </div>
  </body>
</html>
