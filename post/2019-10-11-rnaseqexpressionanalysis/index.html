<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>思考问题的熊</title>
<meta name="description" content="很高兴和你相遇<br>这里正在记录我的所思所学" />
<link rel="shortcut icon" href="https://kaopubear.top//favicon.ico?v=1579399621694">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link href="https://cdn.remixicon.com/releases/v1.3.1/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<link rel="stylesheet" href="https://kaopubear.top//styles/main.css">
<link rel="alternate" type="application/atom+xml" title="思考问题的熊 - Atom Feed" href="https://kaopubear.top//atom.xml">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-91022805-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-91022805-1');
</script>


  </head>
  <body>
    <div id="app" class="main px-4 flex flex-col lg:flex-row">
      <div id="sidebar" class="sidebar-wrapper lg:static lg:w-1/4">
  <div class="lg:sticky top-0">
    <div class="sidebar-content">
      <div class="flex lg:block p-4 lg:px-0 items-center fixed lg:static lg:block top-0 right-0 left-0 bg-white z-50">
        <i class="remixicon-menu-2-line lg:mt-4 text-2xl cursor-pointer animated fadeIn" onclick="openMenu()"></i>
        <a href="https://kaopubear.top/">
          <img class="animated fadeInLeft avatar rounded-lg mx-4 lg:mt-32 lg:mx-0 mt-0 lg:w-24 lg:h-24 w-12 w-12" src="https://kaopubear.top//images/avatar.png?v=1579399621694" alt="">
        </a>
        <h1 class="animated fadeInLeft lg:text-4xl font-extrabold lg:mt-8 mt-0 text-xl" style="animation-delay: 0.2s">思考问题的熊</h1>
      </div>
      
        <div class="animated fadeInLeft" style="animation-delay: 0.4s">
          <p class="my-4 text-gray-600 font-light hidden lg:block">
            文章目录
          </p>
          <div class="toc-container hidden lg:block">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E6%96%87%E7%AB%A0%E4%BF%A1%E6%81%AF">文章信息</a></li>
<li><a href="#%E6%95%B4%E4%BD%93%E4%BB%8B%E7%BB%8D">整体介绍</a></li>
<li><a href="#%E5%85%B3%E4%BA%8E%E5%AE%9A%E9%87%8F%E5%92%8C%E6%AF%94%E5%AF%B9">关于定量和比对</a></li>
<li><a href="#%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80">差异分析基础</a></li>
<li><a href="#%E5%90%84%E7%A7%8D%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE">各种差异表达</a></li>
<li><a href="#%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1">表达分析知识图谱</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      
    </div>
  </div>
</div>

<div class="menu-container">
  <i class="remixicon-arrow-left-line text-2xl cursor-pointer animated fadeIn close-menu-btn" onclick="closeMenu()"></i>
  <div>
    
      
        <a href="/" class="menu" style="animation-delay: 0s">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu" style="animation-delay: 0.2s">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu" style="animation-delay: 0.4s">
          标签
        </a>
      
    
      
        <a href="/post/resource" class="menu" style="animation-delay: 0.6000000000000001s">
          资料
        </a>
      
    
      
        <a href="/post/project" class="menu" style="animation-delay: 0.8s">
          项目
        </a>
      
    
      
        <a href="/post/about" class="menu" style="animation-delay: 1s">
          关于
        </a>
      
    
  </div>
  <div class="site-footer">
    <div class="py-4 text-gray-700">欢迎加入我的 <a href="https://t.zsxq.com/UjiEaYZ" target="_blank">知识星球</a></div>
    <a class="rss" href="https://kaopubear.top//atom.xml" target="_blank">RSS</a>
  </div>
</div>
<div class="mask" onclick="closeMenu()">
</div>
      <div class="content-wrapper py-32 lg:p-8 lg:w-3/4 post-detail animated fadeIn">
        <h1 class="text-3xl font-bold lg:mt-16">转录组表达分析知识图谱</h1>
        <div class="text-sm text-gray-700 lg:my-8">
          2019-10-11 / 6 min read
        </div>
        
          <img class="post-feature-image rounded-lg mx-auto my-4" src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011194155.jpg" alt="">
        
        <div class="post-content yue">
          <h2 id="文章信息">文章信息</h2>
<p>Van den Berge, Koen, Katharina M. Hembach, Charlotte Soneson, Simone Tiberi, Lieven Clement, Michael I. Love, Rob Patro, and Mark D. Robinson. 2019. “RNA Sequencing Data: Hitchhiker’s Guide to Expression Analysis.” Annual Review of Biomedical Data Science 2 (1): 139–73. https://doi.org/10.1146/annurev-biodatasci-072018-021255.</p>
<!-- more -->
<p>Annual Review 系列杂志的综述应该说是综述界的老大哥。最近在 Annual Review of Biomedical Data Science 发表了「另」一篇 RNA-Seq 相关的重磅综述。之所以说是另一篇，因为同期在 Nature Reviews Genetics 发表过一篇看名字就非常霸气的综述：RNA sequencing: the teenage years 。</p>
<figure data-type="image" tabindex="1"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011192144.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="2"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011192145.png" alt="" loading="lazy"></figure>
<p>关于 RNA Sequencing Data: Hitchhiker's Guide to Expression Analysis 这篇综述，它重点关注在** RNA-seq 数据的表达分析方法**，**因此适合用来做转录组数据分析能力的自我检测和学习路径。**这篇文章从转录组数据的整体介绍开始，从比对定量、差异表达基础、差异分析种类，单细胞转录组和长读数转录组几个层面展开，重点在比对定量、差异表达基础、差异分析种类这三部分。作者根据分析步骤介绍了对应的大量分析工具和其使用的计算模型和优势。本文不会对文章进行翻译，只是重点指出我读后比较关注的一些细节。<strong>最后我也会按照综述的主线梳理出主要内容，理出一幅转录组表达分析的知识地图。</strong></p>
<h2 id="整体介绍">整体介绍</h2>
<p>下图是一个转录组试验的标准试验流程。</p>
<figure data-type="image" tabindex="3"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011192149.png" alt="" loading="lazy"></figure>
<p>在建库的过程中，常见文库形式包括单端和单端测序，同时还有非链特异性和链特异性测序。在实验设计方面，有两个比较重要的因素：重复数量和测序深度。如下图所示，最近若干年来，大多数转录组测序的数据 reads 数量都是从 10 到 100M 之间，而样本数量基本上就是每个条件三个重复，很多项目的样本数量在 8 个（中位数）左右。</p>
<figure data-type="image" tabindex="4"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011192150.png" alt="" loading="lazy"></figure>
<p>通常认为，增加测序深度可以提高后期分析的表现。不过，其实非常大的一部分 reads 都来自少数一些表达量很高的基因。具体到统计数字上，超过 80%的 reads 都来自 10%表达量最高的基因，如下图所示。因此，增加 reads 其实只是非常有限的增加了低表达基因的覆盖率。在检查差异表达基因的统计效力上并没有非常明显的提升。<strong>因此，增加测序深度不如多增加几个重复</strong>。有数据表明，如果想要鉴定低 fold change 的基因，最好能够做到 6 个重复。</p>
<figure data-type="image" tabindex="5"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011192146.png" alt="" loading="lazy"></figure>
<p>转录组测序在应用层面可以进行基因注释，这里的注释包括各种各样的转录相关事件，例如 exon skipping, alternative 3' acceptor, 5' donor<br>
sites 以及 intron retention 等等。在基因调控方面，转录组数据可以在各种各样的条件下进行各种各样层面的比较，例如基因、转录本和外显子。当然，还有单细胞转录组的一系列应用场景等等。</p>
<h2 id="关于定量和比对">关于定量和比对</h2>
<p>转录组得到的测序数据通常被称为 junction-spanning reads， 目前针对这样的 reads 有两种最主要的比对思路，一种是使用 spliced alignment 的方法比对到参考基因组，另一种是使用 direct alignment 的方法直接比对到转录组上。往参考基因组比对的方法对应的工具有很多，最早从 DNA 比对进化来的工具例如 bowtie 等，后期发展出来的 STAR, HISAT 和 Subread 以及 GMAP。这种类型的比对一个关键点是对于 splice junctions 的识别。比对到转录组，主要挑战是关于 related isoforms 转录本的区分，这个问题可能会导致大量 multimapping 的情况发生。例如一个基因有三个转录本，其中一个外显子序列可能在三个转录本中都出现。同时，比对到参考转录组也不能找到 find novel splicing 和 expression pattern。因此，到底选择哪种比对方式取决于自己的后续分析需求。关于定量，常见的有基于基因的定量和基因转录本的定量。每种定量方式都有基于不同模型的若干种方法，随着分析的逐渐深入，越来越多的分析从基于基因定量转换为基于转录本定量。</p>
<h2 id="差异分析基础">差异分析基础</h2>
<p>下图是一个常规的差异分析步骤。</p>
<figure data-type="image" tabindex="6"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011192148.png" alt="" loading="lazy"></figure>
<h2 id="各种差异表达">各种差异表达</h2>
<p>和定量的方式相对应，差异表达的分析角度其实也有很多种。除了常见的差异基因表达之外，还有差异表达的转录本，以及在一个基因内部不同转录本的使用情况，在一些情况下，即便一个基因在两种不同的条件下没有表达上的明显差异，但是可能存在不同转录本的表达变化。下图是一个比较直观的说明。</p>
<figure data-type="image" tabindex="7"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011192147.png" alt="" loading="lazy"></figure>
<p>更多细节可以阅读综述原文，送上根据综述这里的知识图谱</p>
<h2 id="表达分析知识图谱">表达分析知识图谱</h2>
<figure data-type="image" tabindex="8"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20191011193739.png" alt="" loading="lazy"></figure>
<hr>
<figure data-type="image" tabindex="9"><img src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" alt="" loading="lazy"></figure>
<p><strong>本文作者</strong>：思考问题的熊</p>
<p><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议 (CC BY-NC-ND 4.0)</a> 进行许可。</p>
<figure data-type="image" tabindex="10"><img src="https://kaopubear-1254299507.cos.ap-shanghai.myqcloud.com/picgo/20190628083754.png" alt="扫码即刻沟通" loading="lazy"></figure>

        </div>

        
          <a class="animated fadeInUp p-2 items-center text-sm text-gray-700 border hover:bg-gray-300 leading-none rounded-full flex lg:inline-flex m-4 " href="https://kaopubear.top/tag/p7M9e5leM">
            <span class="flex-auto">RNA-seq</span>
          </a>
        
          <a class="animated fadeInUp p-2 items-center text-sm text-gray-700 border hover:bg-gray-300 leading-none rounded-full flex lg:inline-flex m-4 " href="https://kaopubear.top/tag/DvI6ypPftI">
            <span class="flex-auto">生物信息</span>
          </a>
        


        <div class="flex justify-between py-8">
          
            <div class="prev-post">
              <a href="https://kaopubear.top/post/2019-10-26-apibasic">
                <h3 class="post-title">
                  <i class="remixicon-arrow-left-line"></i>
                  数据库网站 API 知多少
                </h3>
              </a>
            </div>
          

          
            <div class="next-post">
              <a href="https://kaopubear.top/post/2019-09-17-fasterdeseq2">
                <h3 class="post-title">
                  船新版本 DESeq2 处理大量样本速度显著提升
                  <i class="remixicon-arrow-right-line"></i>
                </h3>
              </a>
            </div>
          
        </div>

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '77b0e0937753a24c7510',
    clientSecret: 'd312ec269767c6310a14f017359734b75a4dc4fc',
    repo: 'fei0810.github.io',
    owner: 'fei0810',
    admin: ['fei0810'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

      </div>
    </div>

    <script src="https://kaopubear.top//media/prism.js"></script>  
<script>

Prism.highlightAll()

let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

// This should probably be throttled.
// Especially because it triggers during smooth scrolling.
// https://lodash.com/docs/4.17.10#throttle
// You could do like...
// window.addEventListener("scroll", () => {
//    _.throttle(doThatStuff, 100);
// });
// Only not doing it here to keep this Pen dependency-free.

window.addEventListener("scroll", event => {
  let fromTop = window.scrollY;

  mainNavLinks.forEach((link, index) => {
    let section = document.getElementById(decodeURI(link.hash).substring(1));
    let nextSection = null
    if (mainNavLinks[index + 1]) {
      nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
    }
    if (section.offsetTop <= fromTop) {
      if (nextSection) {
        if (nextSection.offsetTop > fromTop) {
          link.classList.add("current");
        } else {
          link.classList.remove("current");    
        }
      } else {
        link.classList.add("current");
      }
    } else {
      link.classList.remove("current");
    }
  });
});


document.addEventListener("DOMContentLoaded", function() {
  var lazyImages = [].slice.call(document.querySelectorAll(".post-feature-image.lazy"));

  if ("IntersectionObserver" in window) {
    let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          let lazyImage = entry.target
          lazyImage.style.backgroundImage = `url(${lazyImage.dataset.bg})`
          lazyImage.classList.remove("lazy")
          lazyImageObserver.unobserve(lazyImage)
        }
      });
    });

    lazyImages.forEach(function(lazyImage) {
      lazyImageObserver.observe(lazyImage)
    })
  } else {
    // Possibly fall back to a more compatible method here
  }
});

const menuContainer = document.querySelector('.menu-container')
const menus = document.querySelectorAll('.menu-container .menu')
const mask = document.querySelector('.mask')
const contentWrapper = document.querySelector('.content-wrapper')
const latestArticle = document.querySelector('.latest-article')
const readMore = document.querySelector('.read-more')
const indexPage = document.querySelector('.index-page')

const isHome = location.pathname === '/'
if (latestArticle) {
  latestArticle.style.display = isHome ? 'block' : 'none'
  readMore.style.display = isHome ? 'block' : 'none'
  indexPage.style.display = isHome ? 'none' : 'block'
}

const openMenu = () => {
  menuContainer.classList.add('open')
  menus.forEach(menu => {
    menu.classList.add('animated', 'fadeInLeft')
  })
  mask.classList.add('open')
  contentWrapper.classList.add('is-second')
}

const closeMenu = () => {
  menuContainer.classList.remove('open')
  menus.forEach(menu => {
    menu.classList.remove('animated', 'fadeInLeft')
  })
  mask.classList.remove('open')
  contentWrapper.classList.remove('is-second')
}
</script>
  
  </body>
</html>
